# 4.7 조인의 원리
- 조인의 원리 : 중첩 루프 조인, 정렬 병합 조인, 해시 조인

# 4.7.1 중첩 루프 조인(NLJ, Nested Loop Join)
- 중천 for문과 같은 원리
- 조건에 맞는 조인을 하는 방법
- 랜덤 접근에 대한 비용이 많이 증가하므로 대용량 테이블에서는 사용하지 않음
- t1, t2 테이블 조인 -> 첫 번재 테이블에서 행을 하나씩 읽고 그 다음 테이블에서도 행을 하나씩 읽어 조건에 맞는 레코드를 찬자 반환
- 중첩 루프 조인에서 발전한 블록 중첩 루프 조인(BNL, Block Nested Loop) : 작은 블록으로 나눠 하나씩 조인

# 4.7.2 정렬 병합 조인
- 각가의 테이블을 조인할 필드 기준으로 정렬하고 정렬이 끝난 이후에 조인 작업을 수행하는 조인
- 조인할 때 쓸 적절한 인덱스가 없고 대용량의 테이블들을 조인하고 조인조건으로 <,>등 범위 비교 연산자가 있을 때 사용

# 4.7.3 해시 조인
- 해시 테이블을 기반으로 조인하는 방법
- 두 개의 테이블을 조인한다고 했을 때 하나의 테이블이 메모리 온전히 들어간다면 보통 중첩 루프 조인보다 더 효율적
- 메모리에 올릴 수 없을 정도로 크다면 디스크를 사용하는 비용 발생
- 동등 조인에서만 사용할 수 있음
- MySql8.0.18에서 기능 사용 가능 -> 빌드 단계, 프로브 단계로 나뉨

## 빌드 단계
- 입력 테이블 중 하나를 기반으로 메모리 내 해시 테이블을 빌드하는 단계
- 조인할 두 테이블 중 바이트가 더 작은 테이블을 기반으로 해서 테이블 빌드

## 프로브 단게
- 레코드를 읽기 시작하며, 각 레코드에서 'persons.country_id'에 일치하는 레코드를 찾아 결괏값으로 반환

각 테이블은 한 번씩만 일게 되어 중첩 루프 조인보다 보통 성능이 좋음.  
사용가능한 메모리양은 시스템 변수 join_buffer_size에 의해 제어되며 런타임 시에 조정 가능