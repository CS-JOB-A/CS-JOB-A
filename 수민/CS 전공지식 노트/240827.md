# 2장 네트워크
## 2.5. HTTP
- 애플리케이션 계층
- 웹 서비스 통신에 사용

### (1) HTTP/1.0
- 한 연결당 하나의 요청 처리 -> RTT 증가(서버로부터 파일 가져올 때마다 TCP의 3-웨이 핸드쉐이크를 계속 열어야 하기 때문)
    - RTT: 패킷이 목적지에 도달하고 나서 다시 출발지로 돌아오기까지 걸리는 시간(패킷 왕복 시간)
- RTT 증가 해결 방법
    - 이미지 스폴리팅: 많은 이미지가 합쳐진 하나의 이미지를 다운 받고, 이를 기반으로 background-image의 position을 이용하여 이미지를 표기하는 방법
    - 코드 압축: 코드를 압축해서 개행 문자, 빈칸을 없애서 코드의 크기를 최소화
    - 이미지 Base64 인코딩: 이미지 파일을 64진법으로 이루어진 문자열로 인코딩 -> 이미지에 대해 서버에 HTTP 요청을 할 필요가 없어지나, 인코딩 시 37% 크기가 커지는 단점 

### (2) HTTP/1.1
- 한번 TCP 초기화 이후, keep-alive 옵션으로 여러 개의 파일을 송수신할 수 있게 됨
- 3-웨이 핸드쉐이크 최초 발행 후, 그 다음부터 발생하지 않음
- 단점: 요청 리소스 개수에 비례하여 대기 시간이 길어질 수 있음
- HOL Blocking(Head Of Line Blocking)
    - 네크워크에서 같은 큐에 있는 패킷이 그 첫 번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상
- 무거운 헤더 구조
    - 헤더에는 쿠키 등 많은 메타 데이터가 들어있고, 압축이 되지 않아 무거움

### (3) HTTP/2
- 멀티플렉싱
    -  여러 개의 스트림을 사용하여 송수신 -> 특정 스트림의 패킷이 손실돼도 해당 스트림에만 영향, 나머지 스트림은 멀쩡히 동작
    - 애플리케이션에서 받아온 데이터를 독립된 프레임으로 조각내어 서로 송수신한 후 다시 조립하여 데이터를 주고받음
- 헤더 압축
    - 허프만 코딩 압축 알고리즘 -> HPACK 형식
        - 허프만 코딩
            - 문자열을 문자 단위로 쪼개 빈도수 카운팅 -> 빈도 높은 정보는 적은 비트 수 사용하여 표현, 빈도 낮은 정보는 많은 비트 수 사용 -> 전체 데이터 표현에 필요한 비트양을 줄이는 원리
- 서버 푸시
    - 클라이언트 요청 없이 서버가 바로 리소스 푸시 가능

### (4) HTTPS
- 애플리케이션 계층과 전송 계층 사이에 신뢰 계층인 SSL/TLS 계층을 넣은, 신뢰할 수 있는 HTTP 요청 -> "통신 암호화"
- SSL/TLS(Secure Socket Layer/Transport Layer Security Protocol)
    - 전송 계층에서 보안을 제공하는 프로토콜
    - 클라이언트와 서버가 통신할 때 제3자가 메시지를 도청하거나 변조하지 못하도록 함
        - 인터셉터(공격자가 서버인 척하며 사용자 정보 가로채는 공격) 방지
    - 보안 세션을 기반으로 데이터 암호화. 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 알고리즘, 해싱 알고리즘 등이 사용됨
        - 보안 세션: 보안이 시작되고 끝나는 동안 유지되는 세션(세션이란, 운영체제가 사용자로부터 자신의 자산 이용을 허락하는 일정 기간)
        - 인증 메커니즘
            - CA(Certificate Authorities)에서 발급한 인증서를 기반으로 이루어짐
            - 클라이언트에게 공개키 제공하고, 사용자가 접속한 서버가 신뢰할 수 있음을 보장
        - 암호화 알고리즘
            - ㄱ. 디피-헬만 키 교환 암호화 알고리즘
                - 처음에 공개 값을 공유하고 각자의 비밀 값과 혼합 후 그 혼합 값을 공유
                - 각자 비밀 값과 또 혼합
                - 이후 공통 암호키가 생성
            - ㄴ. 해싱 알고리즘
                - 데이터를 추청하기 힘든 더 작고, 섞인 조각으로 만드는 알고리즘
                - SHA-256 알고리즘
                    - 해시 함수의 결괏값이 256비트
                    - 비트 코인을 비롯한 많은 블록체인 시스템에서 사용
                    - 해싱 해야 할 메시지에 1을 추가하는 증 전처리 -> 전처리된 메시지를 기반으로 해시 반환
    - SEO에도 도움이 되는 HTTPS
        - SEO(Search Engine Potimization): 검색엔진 최적화
        - 서비스 운영 시 SEO 관리는 필수
            - 캐노니컬 설정
            - 메타 설정
            - 페이지 속도 개선
            - 사이트맵 관리
    - HTTPS 구축 방법
        - 직접 CA에서 구매한 인증키를 기반으로 서비스 구축
        - 서버 앞단에 HTTPS를 제공하는 로드밸런서 두기
        - 서버 앞단에 HTTPS를 제공하는 CDN 우기 

### (5) HTTP/3
- HTTP의 세 번째 버전
- UDP 기반으로 QUIC 계층 위에서 돌아감
- 멀티플렉싱 
- 초기 연결 설정 시 지연 시간 감소
    - TCP 사용하지 않으므로 통신 시작 시 번거로운 3-웨이 핸드쉐이크 과정을 거치지 않음
    - 첫 연결 설정에 1-RTT만 소요
        - 클라이언트가 서버에 어떤 신호를 한 번 주고, 서버도 거기에 응답하기만 하면 바로 본 통신 시작 가능